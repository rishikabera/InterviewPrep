Running time is O(nlogn)
